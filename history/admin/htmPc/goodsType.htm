<style type="text/css">
    div#goodstypes > ul > li.showlistle > span:first-child {
        width: 80px;
    }

    div#goodstypes > ul > li.showlistle > span:nth-child(2) {
        width: 150px;
    }

    div#goodstypes > ul > li.showlistle > span:nth-child(3) {
        width: 200px;
    }
</style>
<{if $count ge 1 }>
<div id='goodstypes' class='wins showwin'>
    <span>商品类型</span>
    <ul>
        <li class="showlistle">
            <span>编号</span>
            <span>商品类型名称</span>
            <span>备注</span>
        </li>
        <{section name=index loop=$row}>
        <li class='showlistle showListCons'>
            <span title="<{$row[index]['gt_number']}>"><{$row[index]['gt_number']}></span>
            <span title="<{$row[index]['gt_name']}>"><{$row[index]['gt_name']}></span>
            <span title="<{$row[index]['gt_remark']}>"><{$row[index]['gt_remark']}></span>
            <span class="delete" value="<{$row[index]['gt_id']}>">×</span>
        </li>
        <{/section}>

        <!--分页-->
        <{if $pages['count'] ge $pages['pageRow']+1}>
        <li class="showlistle">
            <div class="<{if $pages['page'] ge 1}> pages button <{else}> pagesoff <{/if}>">上一页</div>
            <{section name=loop loop=$pages['pagess']}>
            <div class="<{if $pages['start']+$smarty.section.loop.index eq $pages['page']}>
                pageis<{/if}>  pageSum button "><{$pages['start']+$smarty.section.loop.index+1 }>
            </div>
            <{/section}>
            <div class="<{if $pages['page']+1 lt $pages['countRow']}> pages button <{else}> pagesoff <{/if}>">下一页</div>
        </li>
        <{/if}>

        <!--搜索-->
        <li class="showlistle">
            <div class="searchtext">
                <input type="text" class="forms" value="<{$pages['search']}>">
            </div>
            <div class="search button">搜索</div>
            <div id="searchDelete" class="delete">×</div>
            <div class="pageRow">
                <div>每页显示</div>
                <span>3</span>
                <span>10</span>
                <span>15</span>
                <span>20</span>
            </div>
        </li>
    </ul>
</div>

<{/if}>
<form action="./server/goodsTypeAdd.php" method="post" id="goodsTypeAddForm">
    <div id = "goodsTypeAdd"  class='wins showwin'>
        <span>添加商品类型</span>
        <div>
            <lable>类型编号</lable>
            <input type="text" name="typeNumber" class="forms"/></div>
        <div>
            <lable>类型名称</lable>
            <input type="text" name="typeName" class="forms"/></div>
        <div >
            <lable>类型备注</lable>
            <input type="text" name="typeRemark" class="forms"/></div>
        <div class='texts'>
            <lable>详细属性</lable>
            <textarea name="typeProp" class="forms"/>

            <div>用,分隔</div>
        </div>
        <div class='texts'>
            <lable>价格属性</lable>
            <textarea name="typePrice" class="forms"/>

            <div>用,分隔，最多4个价格属性</div>
        </div>
        <div>
            <div class="submit button">提交</div>
        </div>
    </div>
</form>
<script type="text/javascript">
    function succ(data) {
        toast(data.status, data.megs);
        $('#contents').load('./inc/goodsType.php');
    }
    function bs() {}
    $(function () {

        $('.submit').click(function () {
            $(this).parents("form").submit();
        });

        //详细资料
        $("li.showListCons").click(function () {
            $.get("./inc/goodsTypeUpdate.php", {'name': $(this).children('span.delete').attr("value")}, function (data) {
                $("body").append(data);
                $('#goodsTypeUpdateWin').slideDown(500);
            });
        });

        //验证
        $.checks.checkform($('#goodsTypeAddForm'), {
            "async": {'success': succ, 'beforeSend': bs},
            "typeNumber": {
                "name": "类型编号",
                "check": ["noSpechars", {"isLength": [4]}, {"isAjax": ["/server/iskeySer.php"]}]
            },
            "typeName": {"name": "类型名称", "check": [{"isAjax": ["/server/iskeySer.php"]}]}
        });

        //排序
        $("li.showlistle:first > span").click(function () {
            var $sort = "ASC";
            if ($(this).html() == $("#sortCache").attr("sortLine")) {
                if ($("#sortCache").val() == "ASC") {
                    $sort = "DESC";
                    $("#sortCache").val("DESC");
                } else {
                    $("#sortCache").val("ASC");
                }
            } else {
                $("#sortCache").attr("sortLine", $(this).html());
                $("#sortCache").val("ASC");
            }
            $('#contents').load('<{$thispath}>?sort=' + $sort + '&sortLine=' + $(this).html());
        });

        //列表搜索
        $("li.showlistle >div.search").click(function () {
            $('#contents').load('<{$thispath}>?page=0&search='+$(".searchtext >input[type='text']").val());
        });

        //列表取消搜索
        $("li.showlistle >div#searchDelete").click(function () {
            $('#contents').load('<{$thispath}>?page=0&searchDelete=true');
        });

        //列表每页多少汗设置
        $("li.showlistle >div.pageRow>span").click(function () {
            $('#contents').load('<{$thispath}>?page=0&pageRow=' + $(this).html());
        });

        //列表选页
        $("li.showlistle >div.pageSum").click(function () {
            $('#contents').load('<{$thispath}>?page='+(parseInt($(this).html())-1));
        });

        //列表翻页
        $("li.showlistle >div.pages").click(function () {
            if ($(this).html() == "下一页") {
                $('#contents').load('<{$thispath}>?page=' + (parseInt($("li.showlistle >div.pageis").html())));
            } else {
                $('#contents').load('<{$thispath}>?page=' + (parseInt($("li.showlistle >div.pageis").html()) - 2));
            }
        });

    });
</script>